<?php
$gemini_api_key = FreshRSS_Context::$user_conf->gemini_api_key ?? '';
$gemini_model = FreshRSS_Context::$user_conf->gemini_model ?? 'gemini-1.5-flash';
$gemini_general_prompt = FreshRSS_Context::$user_conf->gemini_general_prompt ?? 'Please provide a concise summary of the following article content:';
$gemini_youtube_prompt = FreshRSS_Context::$user_conf->gemini_youtube_prompt ?? 'Please provide a concise summary of this YouTube video:';
?>

<form action="<?php echo _url('extension', 'configure', 'e', urlencode($this->getName())); ?>" method="post">
    <input type="hidden" name="_csrf" value="<?php echo FreshRSS_Auth::csrfToken(); ?>" />
    
    <h3>Google Gemini Configuration</h3>
    
    <div class="form-group">
        <label for="gemini_api_key">Google Gemini API Key:</label>
        <input type="password" name="gemini_api_key" id="gemini_api_key" value="<?php echo htmlspecialchars($gemini_api_key); ?>" placeholder="Enter your Google Gemini API key" style="width: 100%; max-width: 400px;">
        <small>Get your API key from <a href="https://ai.google.dev/" target="_blank">Google AI Studio</a></small>
    </div>
    
    <div class="form-group">
        <label for="gemini_model">Gemini Model:</label>
        <select name="gemini_model" id="gemini_model">
            <option value="gemini-1.5-flash" <?php echo ($gemini_model === 'gemini-1.5-flash' ? 'selected' : ''); ?>>Gemini 1.5 Flash</option>
            <option value="gemini-1.5-pro" <?php echo ($gemini_model === 'gemini-1.5-pro' ? 'selected' : ''); ?>>Gemini 1.5 Pro</option>
            <option value="gemini-pro" <?php echo ($gemini_model === 'gemini-pro' ? 'selected' : ''); ?>>Gemini Pro</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="gemini_general_prompt">General Articles Prompt:</label>
        <textarea name="gemini_general_prompt" id="gemini_general_prompt" rows="3" style="width: 100%; max-width: 600px;"><?php echo htmlspecialchars($gemini_general_prompt); ?></textarea>
        <small>This prompt will be used for regular text articles</small>
    </div>
    
    <div class="form-group">
        <label for="gemini_youtube_prompt">YouTube Videos Prompt:</label>
        <textarea name="gemini_youtube_prompt" id="gemini_youtube_prompt" rows="3" style="width: 100%; max-width: 600px;"><?php echo htmlspecialchars($gemini_youtube_prompt); ?></textarea>
        <small>This prompt will be used for YouTube videos (requires video understanding)</small>
    </div>
    
    <hr />
    <button type="submit" class="btn btn-important">Save Configuration</button>
</form>

<style>
.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
}

.form-group small {
    display: block;
    color: #666;
    margin-top: 5px;
    font-style: italic;
}

.form-group input,
.form-group select,
.form-group textarea {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
}
</style>